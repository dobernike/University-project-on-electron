# yandex subbotnik 2018 nov

## Бэкенд слишком важен, чтобы доверять его бэкендерам

[https://youtu.be/XmolVlufZXg]

### BFF (Backend For Frontend)

Проксирующее api на node.js

С клиента идем на фасад node.js, которая обращается к разным бэкендам

на ноде делаем нормализацию плохого ответа бэка

```js
function getItems (response) {
  if (isNull(response)) return []
  if (isObject(response)) return [response]
  return response
}

query: {
  feed_shoffer_id: 'feedShofferId',
  'pi-from': 'piFrom',
  'show-urls': ({showUrls = 'offercard'}) => showUrls,
}
```

#### Плюсы

- Фильтрация
- Агрегация
- Кеширование
- Инкапсуляция
- Микросервисы

#### Минусы

- Сложность
- Дублирование
- Маршрутизация

#### Нужно

- Никакой логики
- Только проксирование (исправление плохого ответа бэка)

### или GraphQL

### Пишем документацию до разработки (думаем над api)

swagger

faker.js (чтобы не ждать back) можно соеденить с swagger и он автоматом будет кидать или JSON Schema

## Мутационное тестирование

[https://youtu.be/yAk69bdhA5w]

### Принцип работы:

- Берем рабочий код
- Модифицируем его
- Прогоняем тесты на каждом "мутанте"
- Если тесты упали, значит мутант убит
- Если тесты зеленые, мутант выжил

MSI - Mutation Score Indicator

### Решение для js - Stryker

Это фреймворк для `мутационного тестирования`
Это не test runner как Karma
Это не test framework как Mocha

Имеет плагинную архитектуру
(stryker-jest-runner, reporter ...)

### Stryker lifecycle

чтение конфига -> загрузка плагинов -> запуск тестов -> генерация мутантов -> запуск тестов на мутантах -> вывод отчета

(stryker run)

### Опыт интеграции, проблемы

- Нельзя просто npm i && stryker run
- CoverageAnalysis иногда не работает
- Worker-ы иногда зависают

### Положительные стороны

- Поддержка Jest, Karma, Mocha, Jasmine
- Многопоточность
- Гибкость

### Выводы

- Мутационное тестирование - хорошее дополнение к инфраструктуре разработки большого проекта
- Stryker подходящий инструмент, хотя немного сыроват
- Хорошо использовать на старте проекта
